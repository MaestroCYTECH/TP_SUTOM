<!DOCTYPE html>
<html lang="fr">

<head>

    <!-- Jquery -->
    <script src="/jquery-3.6.0.js"></script>

</head>

<body style="font-size:45px">
    <div class="container">
        <div class="row">
            <div class="column">
                <h1>LOGIN</h1>
            </div>
        </div>

        <button onclick="document.location='http://localhost:3000/motus.html'"
            style="background-color: green; border-radius: 4 px; opacity: 0.8; width: 30%">
            PLAY</button>



        <div class="row">
            <form id="input" onsubmit="return submit_response()">

                <label>Username :</label>
                <input type="text" id="user" name="user" required> </input><br>

                <label>Password :</label>
                <input type="password" id="password" name="password" required> </input><br>

                <input type="submit" value="Submit">
            </form>

            <span id="response" style="color: red"></span>
        </div>
    </div>
</body>

<script>

    // On envoie les données à l'API Auth qui vérifie si ca correspond bien
    function submit_response() {

        // Appel de l'API auth
        $.ajax({
            url: "http://localhost:3002/check_login",
            type: "POST",
            data: {
                'user': $("#user").val(),
                'password': $("#password").val()
            },
            success: function (data) {
                if (data.status == 'fail') {
                    document.getElementById('response').innerHTML = data.err
                    return false;
                }
                localStorage.setItem('user', data.user);

                // Ces 2 lignes devront etre gerees par l'API score
                /*localStorage.setItem('score', data.score);
                localStorage.setItem('average', data.average);*/

                console.log("User logged in")
                window.location.href = "http://localhost:3000/motus.html";
            }
        })

        return false;
    }

</script>

</html>